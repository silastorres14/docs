---
title: 'Gerenciando Grupos com PowerShell (Graph SDK)'
description: 'Como criar, modificar e gerenciar grupos no Entra ID usando PowerShell'
---

# Gerenciando Grupos com PowerShell (Graph SDK)

O módulo Microsoft.Graph.Groups permite gerenciar grupos no Microsoft Entra ID através do PowerShell, facilitando a organização e delegação de acessos.

## Pré-requisitos

```powershell
# Instalar o módulo e conectar ao Graph
Install-Module Microsoft.Graph.Groups -Scope CurrentUser
Connect-MgGraph -Scopes "Group.ReadWrite.All"
```

## Consultando Grupos

```powershell
# Listar todos os grupos
Get-MgGroup

# Filtrar grupos
Get-MgGroup -Filter "startsWith(displayName, 'TI')"

# Consultar grupo específico por ID
Get-MgGroup -GroupId "group-id"

# Listar membros de um grupo
Get-MgGroupMember -GroupId "group-id"
```

## Criando Grupos

```powershell
# Criar um grupo de segurança
$params = @{
    DisplayName = "Administradores de IAM"
    Description = "Grupo para administradores de Identidade e Acesso"
    MailEnabled = $false
    SecurityEnabled = $true
    MailNickname = "iam-admins"
}

New-MgGroup -BodyParameter $params

# Criar um grupo Microsoft 365
$params = @{
    DisplayName = "Equipe de Projetos"
    Description = "Grupo de colaboração para a equipe de projetos"
    MailEnabled = $true
    SecurityEnabled = $true
    GroupTypes = @("Unified")
    MailNickname = "equipe-projetos"
}

New-MgGroup -BodyParameter $params
```

## Gerenciando Membros

```powershell
# Adicionar membro a um grupo
$userId = (Get-MgUser -Filter "userPrincipalName eq 'user@contoso.com'").Id
New-MgGroupMember -GroupId "group-id" -DirectoryObjectId $userId

# Remover membro de um grupo
Remove-MgGroupMemberByRef -GroupId "group-id" -DirectoryObjectId $userId
```

## Grupos Dinâmicos

```powershell
# Criar um grupo dinâmico baseado em regras
$params = @{
    DisplayName = "Usuários do Departamento de TI"
    Description = "Grupo dinâmico para todos os usuários do departamento de TI"
    MailEnabled = $false
    SecurityEnabled = $true
    MailNickname = "ti-departamento"
    GroupTypes = @("DynamicMembership")
    MembershipRule = "user.department -eq ""IT"""
    MembershipRuleProcessingState = "On"
}

New-MgGroup -BodyParameter $params
``` 